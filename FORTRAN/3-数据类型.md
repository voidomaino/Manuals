# 内部数据类型

**数据** 是自然界中客观事物的符号表示。
表达在程序之内，能够进行处理的数据称为 **数据对象**。

数据分 **数值型数据** ：能够直接进行算术运算（科学计算）的数据，
和 **非数值数据** ：如字符串、文本、表格、图像、声音等。

**数据类型** 是数据的形式化和抽象化说明，说明一类数据的共同特性。
在计算机中，不同的数据类型有不同的
*名称* 、 *表示方法* 、 *运算方式* 、 *存储方式* 和 *取值范围*。

**子数据对象** 是数据对象的一部分，
如数组元素是数组对象的子对象，子串是字符串对象的子对象。

有关运算方式的内容，参考 [表达式](./3-表达式.md) 中的内容。

其中 5 种 **内部数据类型** 能通过修改 `KIND` 值参数确定数据的
存储开销、精度和范围，以对数据类型进行细化。

## 常量和变量

**常量**是直接写在程序中且程序运行期间保持不变的数据，
在程序中直接生成并用于计算和处理。

**变量** 是在程序运行中可随时改变的数据。
每个变量需要一个符合名称规定的唯一合法名称，即 **变量名**。

对变量命名的细节，详见 [名称](./1-名称与关键字.md)。

在内存中每个变量分配若干个连续的存储单元来存放变量的值。
变量名代表该变量存储单元的首地址。

FORTRAN 程序预设了 I-N 规则，将某些变量的类型进行了隐式声明。
使用 [IMPLICIT 语句](./IMPLICIT.md) 来取消或修改隐式声明的作用规则。
隐式声明后接显式声明，则以显示声明为准。
```text
<数值型变量与逻辑型变量显式声明语句> ->   
(INTEGER|REAL|COMPLEX|LOGICAL)["("[KIND=]<KIND 值>")"|*<KIND 值>] [::] <变量名表>|
BYTE [::] <整型变量名表>|
DOUBLE PRECISION [::] <实型变量名表>
<变量名表> -> <变量名>[=<常量>]{, <变量名>[=<常量>]}

<字符型变量显式声明语句> ->
CHARACTER[<类型参数>] [::] <字符变量名表>
<类型参数> -> "("[[LEN=]<无符号整数>,][[KIND=]<无符号整数>]")"|*<无符号整数>
<字符变量名表> -> <变量名>[*<无符号整数>][=<字符串>][,<变量名>[*<无符号整数>][=<字符串>]]
```
`BYTE` 表示整型变量 KIND 值为 1 。
`DOUBLE PRECISION` 表示实型变量 KIND 值为 8 。
只有包含了 `::` 才可以在声明时给变量赋初值。
字符串变量名后接 `*` ，算了，懂的都懂。

## 整型数据

整型常量的表达方式：
```text
<整数> -> [<符号>][[基数]#]<数值>[u][_<KIND 值>]
```
基数最高 36 ，最低 2 ，默认 16 ，不指定默认 10 。
数字部分后面标注一个字母 `u` 表示 `unsigned`

整型数据的 KIND 值：（只对 10 进制有效）

不指定整型 `KIND` 值则默认为 4 ；

| 整型 `KIND` 值 | 字节数 | 二进制位数 | 最大正值                |
| -------------- | ------ | ---------- | ----------------------- |
| 1              | 1      | 8          | 2^7-1                     |
| 2              | 2      | 16         | 2^15-1                  |
| 4              | 4      | 32         | 2^31-1            |
| 8              | 8      | 64         | 2^63-1 |

有符号整数（默认的情况），取值范围 0 在中间，且负数比正数多 1 ，
如 -128~127 。
无符号整数，取值范围从 0 开始数。

整型量的二进制表示：

首位为符号位，0 为正，1 为负；后面的位数为数据的数值部分。
如 `8_1` 的二进制表示为 `00000100`

## 实型数据

实型常量的表达方式：
```text
<小数形式实数> -> [符号](<整数部分>.[<小数部分>]|[<整数部分>].<小数部分>)[_<实型 KIND 值>]
<指数形式实数> -> [符号](<整数部分>.[<小数部分>]|[<整数部分>].<小数部分>)<指数部分>[_<实型 KIND 值>]
<指数部分> -> (E|D)<十进制整数>
```
小数形式实数只能采用 10 进制表示；
如果指数标识为 `D` ，表示数据为双精度实数，KIND 值为 8 ，后面不再指定。

实型数据 KIND 值对应的存储方式、精度和取值范围：

不指定实型 `KIND` 值则默认为 4 ；

| `KIND` 值 | 字节数 | 二进制位数 | 精度 | 取值范围 |
| --------- | ------ | ---------- | ---- | -------- |
| 4         | 4     | 32        | 7 位有效数字  | ±E±38  |
| 8         | 8     | 64        | 15 位有效数字 | ±D±308 |

当实数突破上界，计算机报错；
绝对值小于精度，约化为 0；
超过有效数字，则四舍五入。

实型量的二进制表示：

首位为符号位；
`KIND = 4` 指数部分占有 8 位，且指数变为二进制形式后要加上 126；
`KIND = 8` 指数部分占有 11 位，且指数变为二进制形式后要加上 1022；
数值部分小数点前为 1 舍去，剩下的就是尾数了。

## 复型数据

复型常量的表达方式：
```fortran
(12,34)         ! 就是两个实数用括号包起来，分别对应实部和虚部
(32.45_8,85)    ! 取两个部分最高 KIND 值为标准
```
复型数据 KIND 值对应的存储方式和取值范围：

| `KIND` 值 | 字节数 | 二进制位数 | 精度            | 取值范围  |
| --------- | ------ | ---------- | ----            | --------  |
| 4         | 8      | 64         | 7 位有效数字    | ±E±38     |
| 8         | 16     | 128        | 15 位有效数字   | ±D±308    |

复数的二进制表示：

两个连续的实数合起来。

## 字符型量

字符型常量是由若干个字符构成的字符序列，用成对的单引号或双引号包括表示。

字符型常量的表达方式：
```text
<字符串> -> ('|"){FORTRAN 字符集}('|")[C]
```
字符串后接 `C` 可扩大字符串功能，加入一些非打印字符。

| 表示形式 | 非打印字符                            |
| -------- | ------------------------------------- |
| \A       | BELL                                  |
| \B       | 退格                                  |
| \F       | 进格                                  |
| \N       | 换行                                  |
| \R       | 回车                                  |
| \T       | 水平 TAB                              |
| \V       | 垂直 TAB                              |
| \\\      | \                                     |
| \XHH     | 十六进制编码为 HH 的任意 ASCII 码字符 |
| \OOO     | 八进制编码为 OO 的任意 ASCII 码字符   |

字符串的 KIND 值可以为 1 或 4，但是似乎没什么区别；
字符串有一个特殊的 LEN 值，决定了字符串的长度。
两个默认都为 1 。

字符型数据的二进制表示：

ASCII 码。

## 逻辑型量

逻辑值只有真假两个，在 FORTRAN 中用 `.TURE.` 和 `.FALSE.` 表示。
```text
<逻辑值> -> (.TRUE.|.FALSE.)[_<逻辑型数据 KIND 值>]
```
逻辑型量的 KIND 值决定其存储开销，默认为 4 ，类似整型数据。
`.TURE.` 在存储空间中每位为 `1`，可视为整数值 `-1`；
`.FALSE.` 在存储空间中每位为 `0`，可视为整数值 `0`。

逻辑量的二进制表示：

逻辑量的最后一位为 0 则逻辑值为 `.FALSE.`，最后一位为 1 则逻辑值为 `.TRUE.`。
