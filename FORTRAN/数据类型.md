
# 内部数据类型

**数据** 是自然界中客观事物的符号表示。
表达在程序之内，能够进行处理的数据称为 **数据对象**。
**数据类型** 是数据的形式化和抽象化说明，说明一类数据的共同特性。
**子数据对象** 是数据对象的一部分，
如数组元素是数组对象的子对象，子串是字符串对象的子对象。

在计算机中，不同的数据类型有不同的
名称、表示方法、运算方式、存储方式和取值范围。

FORTRAN 具有丰富的数据类型，
如内部数据类型、派生数据类型、数组类型、指针类型、公用区类型等。

其中 5 种 **内部数据类型** 能通过修改 `KIND` 值参数确定数据的
存储开销、精度和范围，以对数据类型进行细化。

## 常量和变量

**常量**是直接写在程序中且程序运行期间保持不变的数据，
在程序中直接生成并用于计算和处理。

**变量** 是在程序运行中可随时改变的数据。
每个变量需要一个符合名称规定的唯一合法名称，即 **变量名**。

对变量命名的细节，详见
[名称](./名称与字符.md)。

在内存中每个变量分配若干个连续的存储单元来存放变量的值。
变量名代表该变量存储单元的首地址。

在使用变量前，需要通过类型声明语句来定义变量。

在可执行语句前通过类型声明语句对变量类型进行 **显式声明**。

FORTRAN 使用 **I-N 规则**，在使用变量的同时对变量类型完成 **隐式声明**。

I-N 规则规定：变量名以字母 `I J K L M N I J K L M N`
为开头的变量默认为整型变量，其他为实型变量。

隐式声明后接显式声明，则以显示声明为准。

## 整型数据

### 整型常量的表达方式：

```fortran
+10#127_8   ! 表示正的 10 进制整数 KIND 值为 8
127, -128   ! 正号可省略，负号不可
17#2DE110   ! # 号前的数为基数，取值 2~36，无 # 默认 10，单 # 默认 16
127_1       ! 数值后有 _，则 _ 后的数为 KIND 值，取值 1,2,4,8，只对 10 进制有效
```

### `KIND` 值对应的存储方式和取值范围

| 整型 `KIND` 值 | 字节数 | 二进制位数 | 取值范围                |
| -------------- | ------ | ---------- | ----------------------- |
| 1              | 1      | 8          | 256                     |
| 2              | 2      | 16         | 6,5536                  |
| 4              | 4      | 32         | 42,9496,7296            |
| 8              | 8      | 64         | 922,3372,0368,5477,5808 |

对无符号整数，取值范围从 0 开始数，如 0~255，如 `255u_1`，不建议使用；  
对有符号整数，取值范围 0 在中间，且负数比正数多 1，如 -128~127。

### 整型量的运算

整型常量能参与四则运算。

### 整型量的二进制表示

首位为符号位，0 为正，1 为负；
后面的位数为数据的数值部分。

## 实型量

### 实型常量的表达方式

``` fortran
-1.         ! 小数形式实数只能采用 10 进制表示
+.23        ! 小数形式必有小数点，必有整数部分或小数部分
0.0_8       ! _ 后接 KIND 值，取值 4,8，默认为 4
-12.34E2    ! 指数形式就是小数形式加上指数后缀，E 后必为十进制整数
+2.34D4     ! E 表示单精度实数 KIND=4，D 表示双精度实数 KIND=8，指数形式不用 _
```

两种规范化形式表示实数：
1. 数值部分绝对值小于 1 且大于等于 0.1；
2. 数值部分绝对值小于 10 且大于等于 1。

### `KIND` 值对应的存储方式和取值范围

| `KIND` 值 | 字节数 | 二进制位数 | 精度 | 取值范围 |
| --------- | ------ | ---------- | ---- | -------- |
| 4         | 4     | 32        | 7 位有效数字  | ±E±38  |
| 8         | 8     | 64        | 15 位有效数字 | ±D±308 |

当实数突破上界，计算机报错；突破下界，约化为 0；超过有效数字，则四舍五入。

### 实型量的运算方式

实型变量能参与实数四则运算。

### 实型量的二进制表示

首位为符号位；  
`KIND = 4` 指数部分占有 8 位，且指数变为二进制形式后要加上 126；  
`KIND = 8` 指数部分占有 11 位，且指数变为二进制形式后要加上 1022；  
数值部分小数点前为 1 舍去，剩下的就是尾数了。

## 复型量

### 复型常量的表达方式

```fortran
(12,34)     ! 就是两个实数用括号包起来
(32.45_8,85)    ! 取两个部分最高 KIND 值为标准
```

### `KIND` 值对应的存储方式和取值范围

| `KIND` 值 | 字节数 | 二进制位数 | 精度            | 取值范围  |
| --------- | ------ | ---------- | ----            | --------  |
| 4         | 8      | 64         | 7 位有效数字    | ±E±38     |
| 8         | 16     | 128        | 15 位有效数字   | ±D±308    |

### 复型常量的运算方式

复型常量能进行复数四则运算。

### 复数的二进制表示

两个连续的实数合起来。

## 字符型量

字符型常量是由若干个字符构成的字符序列，用成对的单引号或双引号包括表示。

### 字符型常量的表达方式

```fortran
"Hello, world!"             ! 字符串没有 KIND 值，而有长度，头尾引号不记长度
"I'm a newbie to FORTRAN"   ! 当字符串中出现单引号时，用双引号包括字符串
'I''m a newbie to FORTRAN'  ! 或者两个单引号表示一个单引号，多占长度
```

字符串后接 `C` 可扩大字符串功能，加入一些非打印字符。

| 表示形式 | 非打印字符                            |
| -------- | ------------------------------------- |
| \A       | BELL                                  |
| \B       | 退格                                  |
| \F       | 进格                                  |
| \N       | 换行                                  |
| \R       | 回车                                  |
| \T       | 水平 TAB                              |
| \V       | 垂直 TAB                              |
| \\\      | \                                     |
| \XHH     | 十六进制编码为 HH 的任意 ASCII 码字符 |
| \OOO     | 八进制编码为 OO 的任意 ASCII 码字符   |

### 字符型数据的二进制表示

ASCII 码。

## 逻辑型量

逻辑值只有真假两个，在 FORTRAN 中用 `.TURE.` 和 `.FALSE.` 表示。

```fortran
.TRUE._8    ! 逻辑值有 KIND 值，取值 1,2,4,8，默认为 4
```

### 逻辑量的运算方式

逻辑值能够作为整数参与运算，
`.TURE.` 在存储空间中每位为 `1`，可视为整数值 `-1`；
`.FALSE.` 在存储空间中每位为 `0`，可视为整数值 `0`。

[comment]: # (在gfortran中不适用)

### 逻辑量的二进制表示

逻辑量的最后一位为 0 则逻辑值为 `.FALSE.`，最后一位为 1 则逻辑值为 `.TRUE.`。
