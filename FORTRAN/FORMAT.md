
# FORMAT

`FORMAT` 语句为格式说明语句，用以描述输入输出的格式。


`r` 表示重复次数，`w`表示整数输入输出域宽，

输入时：
逗号强行终止一次数据输入；
域宽达到后自然终止一次数据输入，空格占域宽，不终止数据输入；
数据不能超出声明范围，否则报错；
数据不能小于类型精度，否则视为 0；
如果没有使用特定编辑符，只能以十进制输入。

输出时：
右对齐，域宽足够则补空格；
宽度超过域宽则填满 `*`，符号和小数点占一位域宽。

## 整数

| 编辑符      | 功能                         |
| ----------- | ---------------------------- |
| `[r]Iw[.m]` | 将整数按照指定的域宽输入输出 |

`m` 为最少输出位数：根据最少输出位数在空格内填补 `0`，直到数值部分的位数为 m，
符号不包括在内。

## 实数

对于不同的表达形式可以有不同的输入输出格式。

### 小数

| 编辑符  | 功能                           |
| --------- | ------------------------------ |
| `[r]Fw.d` | 将小数型实数按指定域宽输入输出 |

`d` 表示小数的精度。

输入时如果没有小数点则根据 `d` 值强行添加小数点；
如果有小数点，则以小数点为准，小数点占一位；
最后输入数据要符合变量类型的精度，根据精度四舍五入得到真实的输入值。

输出时优先保证整数部分和小数部分 d 位的输出，视情况四舍五入、补零和补空格；
如果不能保证，则报错。


### 指数

| 编辑符      | 功能                                 |
| ------------- | ------------------------------------ |
| `[r]Ew.d[Ee]` | 将指数型实数按指定域宽输入输出       |
| `[r]ENw.d[Ee]` | 将指数型实数按工程计数法输入输出       |
| `[r]ESw.d[Ee]` | 将指数型实数按科学计数法输入输出       |
| `[r]Dw.d`     | 将双精度指数型实数按指定域宽输入输出 |

`d` 表示小数的精度；`e` 表示指数的精度，不包括正负号，默认为2。

输入时如果域宽内没有 `E`，则如同小数处理；
如果域宽内有 `E` 则此前的部分作为小数，其后的部分作为整数，确保不超过精度。

输出时先将数据转化为数值部分满足 $0 \sim 1$ 的指数形式实数；
指数部分保留四个域宽，写为 `E+xx`（当 `kind = 8` 时 `E` 省略）；
对数值部分，四舍五入或者补全到小数点后第 `d` 位，塞进剩余的域宽之中，
小数点占一位，负号占一位，`0` 可以省略，不省略就要补全；
视情况四舍五入、补零和补空格；
如果域宽无法保证基本的精度，则报错。

## 复数

复数的输入输出编辑符通过两个实数编辑符实现，
一个复数需要两个实数输入，依次赋值给实部和虚部，
输出的时候也需要两个实数输出编辑符。

## 字符串

| 编辑符  | 功能                       |
| --------- | -------------------------- |
| `[r]A[w]` | 将字符串按指定域宽输入输出 |
| `'', ""`  | 直接输出字符串                 |

输入时如果没有指定域宽，则以输入输出表中的变量或表达式的长度为域宽；
域宽和长度不同，则先根据域宽截取，长度多余则考虑补充空格，域宽多余则以右对齐原则赋值。

输出时：同样域宽小则截取，域宽大则右对齐。

字符串编辑符可以直接作为编辑符插入到格式说明表中，内部的字符串直接显示。

## 逻辑值的输入输出

| 编辑符 | 功能                       |
| -------- | -------------------------- |
| `[r]Lw`  | 将逻辑值按指定域宽输入输出 |

域宽缺省为 `2`。

输入时：域宽内出现的第一个 `T(t)` 或 `F(f)` 决定输入的值，如需要分隔，应使用逗号而不空格。

输出时：在对应的域宽内右对齐输出 `T` 或 `F`。

## 二进制数据的输入、输出

| 编辑符    | 功能                                 |
| ----------- | ------------------------------------ |
| `[r]Bw[.m]` | 将二进制整数按照指定的域宽输入输出   |
| `[r]Ow[.m]` | 将八进制整数按照指定的域宽输入输出   |
| `[r]Zw[.m]` | 将十六进制整数按照指定的域宽输入输出 |

这三个编辑符可以根据变量的类型输入或输出整型、实型、复型、字符型和逻辑型数据。

输入时，按域宽截取数据，去掉空格；

输出时，右对齐，填满 `*`，补齐 `0`。

## 排版工具

| 编辑符     | 功能                                             | 输入 | 输出 |
| ------------ | -------------------------------------------------| ---- | ---- |
| `nH`         |                                                  |      |      |
| `Q`          | 获取下一项字符串输入的长度赋值给对应的变量       | √    |      |
| `Tn`         | 下一个输入或输出从本行的第 n 个字符开始算起；    |      |      |
| `TLn`        | 下一个输入或输出从光标左边的第 n 个字符开始算起  |      |      |
| `TRn`        | 下一个输入或输出从光标右边间隔 n 个字符开始算起  |      |      |
| `nX`         | 输入时，跳过 n 个字符；输出时，插入 n 个空格     | √    | √    |
| `SP,SS,S`    |                                                  |      |      |
| `/`          | 结束本行，从下一行开始                           | √    | √    |
| `\`          | 下一行和本行连接                                 |      | √    |
| `$`          | 下一行和本行连接                                 |      | √    |
| `:`          | 冒号前的输出向完成之后马上结束输出               |      | √    |
| `kP`         |                                                  |      |      |
| `BN,BZ`      |                                                  |      |      |
